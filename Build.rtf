{\rtf1\mac\ansicpg10000\cocoartf102
{\fonttbl\f0\fswiss\fcharset77 Helvetica-Bold;\f1\fswiss\fcharset77 Helvetica;}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww14040\viewh10200\viewkind0
\pard\tx360\tx720\tx1080\tx1440\tx1800\tx2160\tx2520\tx2880\tx3240\tx3600\tx3960\tx4320\tx4680\tx5040\tx5400\tx5760\tx6120\tx6480\tx6840\tx7200\tx7560\tx7920\tx8280\tx8640\tx9000\tx9360\tx9720\tx10080\tx10440\tx10800\tx11160\tx11520\tx11880\tx12240\tx12600\tx12960\tx13320\tx13680\tx14040\tx14400\tx14760\tx15120\tx15480\tx15840\tx16200\tx16560\tx16920\tx17280\tx17640\tx18000\tx18360\tx18720\tx19080\tx19440\tx19800\tx20160\tx20520\tx20880\tx21240\tx21600\tx21960\tx22320\tx22680\tx23040\tx23400\tx23760\tx24120\tx24480\tx24840\tx25200\tx25560\tx25920\tx26280\tx26640\tx27000\tx27360\tx27720\tx28080\tx28440\tx28800\tx29160\tx29520\tx29880\tx30240\tx30600\tx30960\tx31320\tx31680\tx32040\tx32400\tx32760\tx33120\tx33480\tx33840\tx34200\tx34560\tx34920\tx35280\tx35640\tx36000\ql\qnatural

\f0\b\fs24 \cf0 Overview
\f1\b0 \
\
The Ext2 (and Ext3) source consists of several code bases culled from three different operating systems (FreeBSD, Linux, and Darwin) and brand new code written specifically for the Mac OS X port. As such, it can be rather mystifying to those wishing to understand or contribute to the project. This overview will cover the high level design of the project including the various components and how they interact.\
\
Kernel Driver - This is the core of the project. It implements the algorithms that translate the Ext2 on-disk format into something the Mac OS X kernel can understand. The source files for this component are located in src/gnu/ext2fs and src/kern. The files in src/kern are Mac OS X specific. Recommended starting points: src/gnu/ext2fs/ext2_vfsops.c and src/gnu/ext2fs/ext2_vnops.c -- these implement the entry points for the OS X Kernel to manipulate the file system.\
\
e2fsprogs - This is a collection of userland utilities that manage Ext2 filesystems. They include fsck, mke2fs, debugfs, tunefs, etc. The source for all e2fsprogs utils are located in src/e2fsprogs. The ./e2fsprogsbuild.sh script is used to build the Darwin version.\
\
mount_ext2 - This component mounts Ext2 volumes, loading the kernel extension if necessary. The source files are located in src/mount_ext2fs.\
\
ext2.fs - This component is the glue that allows Mac OS X to "auto-mount" Ext2 partitions. It's main function is to describe the filesystem attributes so the auto-mount daemon can match a disk filesystem and then mount it. The source for the matching utility is located in src/ext2util.c. \
\
ExtFS Manager - This component is a Mac OS X Preference Pane plug-in. It allows the user to set mount options for Ext2 filesystems through a user-friendly GUI. It also provides detailed descriptions of all disks and filesystems. The source for this component is located in src/extfsmgr.\
\
All components are written in the C language, except for ExtFS Manager which is written in Objective-C.\

\f0\b \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\ql\qnatural
\cf0 Setup
\f1\b0 \
\
Certain links must be created and permissions changed on some scripts. The "setup.sh" script performs the necessary actions.\
\
chmod u+x ./setup.sh\
./setup.sh
\f0\b \
\pard\tx360\tx720\tx1080\tx1440\tx1800\tx2160\tx2520\tx2880\tx3240\tx3600\tx3960\tx4320\tx4680\tx5040\tx5400\tx5760\tx6120\tx6480\tx6840\tx7200\tx7560\tx7920\tx8280\tx8640\tx9000\tx9360\tx9720\tx10080\tx10440\tx10800\tx11160\tx11520\tx11880\tx12240\tx12600\tx12960\tx13320\tx13680\tx14040\tx14400\tx14760\tx15120\tx15480\tx15840\tx16200\tx16560\tx16920\tx17280\tx17640\tx18000\tx18360\tx18720\tx19080\tx19440\tx19800\tx20160\tx20520\tx20880\tx21240\tx21600\tx21960\tx22320\tx22680\tx23040\tx23400\tx23760\tx24120\tx24480\tx24840\tx25200\tx25560\tx25920\tx26280\tx26640\tx27000\tx27360\tx27720\tx28080\tx28440\tx28800\tx29160\tx29520\tx29880\tx30240\tx30600\tx30960\tx31320\tx31680\tx32040\tx32400\tx32760\tx33120\tx33480\tx33840\tx34200\tx34560\tx34920\tx35280\tx35640\tx36000\ql\qnatural
\cf0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\ql\qnatural
\cf0 Dependencies
\f1\b0 \
\
You will need the following external code to build Ext2FS.\
\
The disklib Darwin project. This is available from Apple's Darwin CVS repository. You'll want to checkout "diskdev_cmds/disklib". After checking out the project, cd to the dir, then 'make' and 'make install'.\
\
The July, August, Oct (and it seems Dec) 2002 tools removed vital kernel headers from the Kernel framework  and they have to be added back in manually from Darwin CVS.\
\
Here is a list of the missing headers. These can be found in xnu/bsd/ in the Darwin repository.\
\
sys/unistd.h\
netinet/in_var.h\
netinet6/in6_var.h\
sys/signalvar.h\
ufs/ufs/*.h\
netinet/ip_var.h\
netinet/tcp_var.h\
netkey/key_var.h\
\
Once you have checked these headers out, you will need to copy them to "/System/Library/Frameworks/Kernel.framework/Versions/Current/Headers".\
\

\f0\b e2fsprogs Notes
\f1\b0 \
\
If you are working from pre-A1 sources, you will have to update your e2fsprogs dir to the latest vendor code.\
\
cd src/\
rm -rf e2fsprogs\
cvs up e2fsprogs\
\
If you are having problems with e2fsprogs, do a clean build (this is necessary, if non-vendor changes have been made):\
\
cd src/e2fsprogs\
rm ./.e2configdone\
make clean\
cd ../..\
./e2fsprogsbuild.sh\
\

\f0\b e2undel Notes
\f1\b0 \
\
e2fsprogs must be installed. Easiest way to do this correctly, is to install the Ext2FS package.\
\
Now, you can build the e2undel target in the project.\
\
}